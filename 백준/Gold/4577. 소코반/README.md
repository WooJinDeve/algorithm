# [Gold III] 소코반 - 4577 

[문제 링크](https://www.acmicpc.net/problem/4577) 

### 성능 요약

메모리: 18412 KB, 시간: 272 ms

### 분류

구현(implementation), 시뮬레이션(simulation)

### 문제 설명

<p><img alt="" src="" style="float:right; height:178px; width:200px">소코반은 1982년에 일본에서 만들어진 게임으로, 일본어로 창고지기라는 뜻이다. 이 게임은 캐릭터를 이용해 창고 안에 있는 박스를 모두 목표점으로 옮기는 게임이다. 목표점의 수와 박스의 수는 같다. 플레이어는 화살표(위, 아래, 왼쪽, 오른쪽)를 이용해 캐릭터를 아래와 같은 규칙으로 조정할 수 있다.</p>

<ul>
	<li>캐릭터에게 지시한 방향이 빈 칸(박스나 벽이 아닌 곳)인 경우에는 그 칸으로 이동한다.</li>
	<li>지시한 방향에 박스가 있는 경우에는, 박스를 민다. 이 경우에는 박스가 이동할 칸도 비어있어야 한다.</li>
	<li>지시한 방향이 벽인 경우, 또는 박스가 있는데, 박스가 이동할 칸에 다른 박스나 벽이 있는 경우에는 키를 눌러도 캐릭터는 이동하지 않는다.</li>
</ul>

<p>모든 박스를 목표점으로 이동시킨 경우에 게임은 끝난다. 게임이 끝난 후에 입력하는 키는 모두 무시된다.</p>

<p>준규는 소코반으로 고통받는 친구들을 위해서 소코반의 해를 찾는 프로그램을 작성하려고 한다. 하지만, 소코반의 해를 찾는 문제는 NP-hard와 PSPACE-complete에 속하고, 매우 어려운 문제이다. 따라서, 간단한 소코반 프로그램을 작성해보려고 한다.</p>

<p>사용자가 입력한 키가 순서대로 주어졌을 때, 게임이 어떻게 진행되는지를 구하는 프로그램을 작성하시오.</p>

<p>게임의 상태는 아래와 같은 문자로 나타낼 수 있다.</p>

<table class="table table-bordered" style="width:50%">
	<thead>
		<tr>
			<th style="width:20%">문자</th>
			<th style="width:40%">뜻</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>.</td>
			<td>빈 공간</td>
		</tr>
		<tr>
			<td>#</td>
			<td>벽</td>
		</tr>
		<tr>
			<td>+</td>
			<td>비어 있는 목표점</td>
		</tr>
		<tr>
			<td>b</td>
			<td>박스</td>
		</tr>
		<tr>
			<td>B</td>
			<td>목표점 위에 있는 박스</td>
		</tr>
		<tr>
			<td>w</td>
			<td>캐릭터</td>
		</tr>
		<tr>
			<td>W</td>
			<td>목표점 위에 있는 캐릭터</td>
		</tr>
	</tbody>
</table>

<p>첫 번째 입력은 문제의 그림과 같다.</p>

### 입력 

 <p>입력은 여러 개의 테스트 케이스로 이루어져 있다.</p>

<p>각 테스트 케이스의 첫째 줄에는 행과 열의 수 R, C가 주어진다. (4 ≤ R ≤ 15, 4 ≤ C ≤ 15) 다음 R개 줄에는 현재 게임의 상태가 주어진다. 모든 줄은 C개의 문자로 이루어져 있다. 마지막 줄에는 플레이어가 입력한 키가 순서대로 주어지며 길이는 최대 50이다. 위, 아래, 왼쪽, 오른쪽은 U, D, L, R로 나타낸다.</p>

<p>입력의 마지막 줄에는 0 0이 주어진다.</p>

<p>입력으로 주어지는 모든 데이터는 항상 캐릭터가 한 명이고, 박스의 수와 목표점의 수는 같다. 또, 목표점 위에 올라가 있지 않은 박스는 적어도 한 개 이며, 가장 바깥쪽 칸은 항상 벽이다.</p>

### 출력 

 <p>각각의 게임에 대해서, 게임 번호를 출력한 다음에 게임이 끝났으면 complete를, 아니면 incomplete를 출력한다. 그 다음 줄부터 R개 줄에는 게임의 상태를 출력한다.</p>

